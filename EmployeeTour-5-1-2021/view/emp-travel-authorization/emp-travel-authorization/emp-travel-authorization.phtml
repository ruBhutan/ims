<?php
 $title = 'Travel Authorization';
 $this->headTitle($title);
?>

<div class="right_col" role="main">
          <div class="">
            <div class="col-md-12 col-xs-12">
              <div class="x_panel">
                <div class="x_title">
                  <h2><?php echo $this->escapeHtml($title); ?></h2>
                  <ul class="nav navbar-right panel_toolbox">
                    <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a></li>
                  </ul>
                 <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <h5><i>*Please add the Travel Authorization details prior to filling the Travel Details.</i></h5>
                  <br />
                  <div class="x_content">
				          <?php
                    // Opening of the form tag
                    $form->prepare();
                    echo $this->form()->openTag($form);
				            $travel = $form->get('emptravelauthorization');
                    echo $this->form()->openTag($form);
                    echo $this->formHidden($travel->get('id'));
                    $travel->get('employee_details_id')->setValue($this->employee_details_id);
                    $travel->get('applied_by_id')->setValue($this->employee_details_id);
                   // / $travel->get('officiating_staff')->setValueOptions($this->employeeList);
                    $travel->get('tour_status')->setValue('Pending');
                    $travel->get('organisation_id')->setValue($this->organisation_id);
                    echo $this->formHidden($travel->get('employee_details_id'));
                    echo $this->formHidden($travel->get('applied_by_id'));
                    echo $this->formHidden($travel->get('tour_status'));
                    echo $this->formHidden($travel->get('organisation_id'));
                 ?>

                 <?php 
                    if ($this->message == NULL && $this->flashMessenger()->hasMessages()) {
                        echo '<div class="alert alert-success alert-dismissible fade in" role="alert">';
                        echo '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>';
                        $messages = $this->flashMessenger()->getMessages();
                        foreach($messages as $message) {
                            echo '<strong>Success!</strong>'. $message;
                        }
                        echo '</div>';
                    }

                    else if($this->message == 'Failure' && $this->flashMessenger()->hasMessages()){
                        echo '<div class="alert alert-danger alert-dismissible fade in" role="alert">';
                        echo '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>';
                        $messages = $this->flashMessenger()->getMessages();
                        foreach($messages as $message) {
                            echo '<strong>Failure!</strong>'. $message;
                        }
                        echo '</div>';
                    }

                ?>
                 
                    <div class="row" > 
                        <div class="col-md-3 col-sm-12 col-xs-12 form-group">
                         <label>Travel Authorization Date:<span>*</span></label>
                         <?php  echo $this->formRow($travel->get('travel_auth_date')); ?>
                        </div>
                        <div class="col-md-3 col-sm-12 col-xs-12 form-group">
                         <label>Esimated No. of Days:<span>*</span>  </label>
                      	 <?php  echo $this->formRow($travel->get('no_of_days')); ?>
                        </div>
                        <div class="col-md-3 col-sm-12 col-xs-12 form-group">
                         <label>Start Date:<span>*</span>  </label>
                         <?php  echo $this->formRow($travel->get('start_date')); ?>
                        </div>
                        <div class="col-md-3 col-sm-12 col-xs-12 form-group">
                         <label>End Date:<span>*</span>  </label>
                         <?php  echo $this->formRow($travel->get('end_date')); ?>
                        </div>
                    </div>
                    <br />
                    <div class="row" >
                        <div class="col-md-4 col-sm-12 col-xs-12 form-group">
                         <label>Estimated Travel Expenses Nu.:<span>*</span></label>
                         <?php  echo $this->formRow($travel->get('estimated_expenses')); ?>
                        </div>
                        <div class="col-md-4 col-sm-12 col-xs-12 form-group">
                         <label>Advance Required Nu.:<span>*</span></label>
                         <?php  echo $this->formRow($travel->get('advance_required')); ?>
                      	</div>
                        <div class="col-md-4 col-sm-12 col-xs-12 form-group">
                         <label>Attach Document: <small><i>(Optional)</i></small></label>
                         <?php  echo $this->formRow($travel->get('related_document_file')); ?>
                        </div>
                     </div>
                     <br />
                     <div class="row" >
                        <div class="col-md-4 col-sm-12 col-xs-12 form-group">
                         <label>Officiating Staff: <small><i><font color="red">(This is an optional field. If you are approving authority then you need to select your officiating or else don't select)</small></font></i></label>
                         <?php  echo $this->formRow($travel->get('officiating_staff')
                                          ->setAttribute('options', $this->employeeList)); 
                                          ?>
                        </div> 
                        <div class="col-md-8 col-sm-12 col-xs-12 form-group">
                         <label>Purpose of Tour:<span>*</span></label>
                         <?php  echo $this->formRow($travel->get('purpose_of_tour')); ?>
                        </div>
                     </div>
                     
                     <div class="row">
                        <div class="ln_solid"></div>
                        <div class="form-group">
                        <label class="control-label col-md-5 col-sm-12 col-xs-12"></label>
                        <div class="col-md-5 col-sm-12 col-xs-12">
						   <?php  
                            echo $this->formHidden($form->get('csrf'));
                            echo $this->formRow($travel->get('submit')); ?>
                      <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
                        <script type="text/javascript">
                            $(window).on('beforeunload', function () {
                                $("input[type=submit], input[type=button]").prop("disabled", "disabled");
                            });
                        </script>
			</div>
                        </div>
                	</div>

			  </div> <!-- End of x-content -->
            </div> 
           </div>
        </div>
       </div>
      </div>
	</div>
</div>
